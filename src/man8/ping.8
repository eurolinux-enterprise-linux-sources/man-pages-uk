." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "ping" "8" "2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "2007-10-27-16:31"

." PING 8 2007-10-23 iputils-021109 

.SH "Назва"
.PP
ping, ping6 \- посилають ICMP\-сигнал ECHO_REQUEST машинам мережі 

.SH "Стислий огляд"
.PP
\fBping  [\-LRUbdfnqrvVaAB]  [\-c \fR\fIкількість\fR\fB]  [\-i \fR\fIінтервал\fR\fB]\fR \fB[\-l \fR\fIзаряд\fR\fB] [\-p \fR\fIшаблон\fR\fB] [ \-s \fR\fIрозмір_пакету\fR\fB] [ \-t \fR\fIttl\fR\fB]\fR \fB[\-w \fR\fIчас_роботи\fR\fB] [\-F \fR\fIмітка_потоку\fR\fB] [ \-I \fR\fIадреса_інтерфейсу\fR\fB]\fR \fB[\-M \fR\fIстратегія\fR\fB]\fR \fB[ \-P \fR\fIповедінка\fR\fB] [\-Q \fR\fItos\fR\fB] [\-S \fR\fIрозмір_буферу\fR\fB] [\-T \fR\fIопція_мітки_часу\fR\fB]\fR \fB[\-W \fR\fIчас_на_відповідь\fR\fB] [\fR\fIтранзитна_машина\fR\fB...] \fR\fIпризначення\fR 

.SH "Опис"
.PP
Програма \fBping\fR застосовує обов'язкову данограму ECHO_REQUEST протоколу ICMP, щоб домогтися відповіді ECHO_RESPONSE протоколу ICMP від машини чи шлюзу. Данограми ECHO_REQUEST включають IP та ICMP\-заголовок, після якого слідує struct timeval (структура timeval), і наприкінці певна кількість байтів\-заповнювачів, щоб доповнити пакет. 

.SH "Ключі"
.PP

.TP
.B \fB\-a\fR
 Пінгування з поданням звукового сигналу. 
.TP
.B \fB\-A\fR
 Адаптивне пінгування. Міжпакетний інтервал адаптується до часу обігу пакетів, так, щоб не більше одного (або більше одного, якщо задано аргумент preload опції \fB\-l\fR) запитів без відповіді присутні в мережі. Мінімальний інтервал складає 200 мілісекунд для звичайних користувачів. В мережах з низьким показником періоду обігу (rtt \- round\-trip time), цей режим фактично еквівалентний повеневому (опція \fB\-f\fR). 
.TP
.B \fB\-b\fR
 Дозволяє пінгувати трансляційну адресу. 
.TP
.B \fB\-B\fR
 Забороняє програмі \fBping\fR змінювати первісну адресу пакетів. Таким чином, адреса буде прив'язана до певної обраної під час запуску \fBping\fR. 
.TP
.B \fB\-c\fR\fI кількість\fR
 Зупиниться після відправки вказаної \fIкількості\fR ECHO_REQUEST\-пакетів. Разом із параметром \fIтермін\fR, опції \fB\-w\fR, очікуватиме вказану \fIкількість\fR ECHO_REPLY\-пакетів доти, доки не закінчиться заданий \fIтермін\fR очікування. 
.TP
.B \fB\-d\fR
 Встановлює опцію SO_DEBUG для використовуваного сокету. По суті, ця опція сокету не використовується ядром Лінакса. 
.TP
.B \fB\-F\fR\fI мітка потоку\fR
 Виділяє та встановлює 20\-бітну потокову мітку ECHO_REQUEST\-пакетів. (Чинне тільки для \fBping6\fR.) Якщо це значення рівне нулю, ядро призначає довільну потокову мітку. 
.TP
.B \fB\-f\fR
 Повеневий пінг. Для кожного відправленого пакету ECHO_REQUEST виводиться крапка ".", тоді як для кожного отриманого ECHO_REPLY \- реверс (що видаляє виведену крапку). Це забезпечує наглядною ілюстрацією кількості відкинутих пакетів. Якщо інтервал не задано, \fBping\fR встановить його до нуля, і виводитиме пакети настільки швидко, наскільки повертається відповідь на них, або ж одну сотню разів на секунду, в залежності від того, яке з цих значень більше. Тільки надкористувач може використати цю опцію з нульовим інтервалом. 
.TP
.B \fB\-i\fR\fI інтервал\fR
 Чекатиме заданий \fIінтервал\fR часу до того, як відіслати наступний пакет. Стандартний інтервал дорівнює одній секунді, або нулю в повеневому режимі (дивіться опцію \fB\-f\fR). Тільки надкористувач може встановити значення інтервалу менше за 0.2 секунди. 
.TP
.B \fB\-I\fR\fI адреса інтерфейсу\fR
 Встановлює адресу відправника як зазначену \fIадресу_інтерфейсу\fR. Останнє може бути як числовою IP\-адресою, так і пристроєвою назвою. Якщо пінгувати link\-local IPv6\-адресу, ця опція обов'язкова. 
.TP
.B \fB\-l\fR\fI заряд\fR
 Якщо вказано аргумент \fIзаряд\fR, \fBping\fR відішле цю кількість пакетів, не очікуючи відповіді. Тільки надкористувач може обрати \fIзаряд\fR більший за 3. 
.TP
.B \fB\-L\fR
 Пригнічує кільцеве повернення пакетів групової трансляції. Цей прапорець застосовний тільки, коли місцем призначення \fBping\fR служить адреса групової трансляції. 
.TP
.B \fB\-n\fR
 Числовий вивід (адрес). Не робитиметься спроба здобуття символічних назв адрес машин. 
.TP
.B \fB\-P\fR\fI поведінка\fR
 Переважить системне поводження згідно з правилами IPsec. Аргумент може складатися з ланцюжка у форматі, описаному в сторінці \fBipsec_set_policy\fR(3). Наприклад: "out bypass" \- дає змогу обійти цілосистемні стандарти, "out ipsec esp/transport//require" \- вимагає відсилки ping\-пакетів, використавши ESP в транспотрабельному режимі. 

."  FIXME ^^^^^ 

.TP
.B \fB\-p\fR\fI ланцюжок\fR
 Ви можете вказати до 16\-и байтів\-заповнювачів для доповнення пакетів, які ви відсилаєте. Це зручно для діагностики проблем мережі, пов'язаних із даними. Так, наприклад, "\-p ff" спричинить до того, що пакети буде заповнено самими одиницями. 
.TP
.B \fB\-Q\fR\fI код\fR
 Додає до ICMP\-данограм біти, пов'язані з якістю сервісу. \fIкод\fR може складатися з десяткового або шістнадцяткового номеру. Традиційно (згідно з RFC1349), ці номери інтерпретовано як: 0 \- резервований (на сьогодняшній день, його переозначено як номер керування над перевантаженням), 1\-4 \- позначають тип сервісу, а 5\-7 \- пріоритет. Можливими значеннями типу сервісу є: 0x02 \- мінімальне навантаження, 0x04 \- надійність, 0x08 \- висока прохідна здатність, 0x10 \- мінімальна затримка. Одночасне встановлення різноманітних бітів типу сервісу \- небажане. Можливими настройками пріоритету може бути діапазон від 0x20 (високий пріоритет) до 0xe0 (саморегулювання мережею). Ви повинні бути надкористувачем (мати властивість CAP_NET_ADMIN), щоб бути в змозі використати критичне або високопріоритетне значення. Ви не зможете встановити резервований біт 0x01, якщо в ядрі не ввімкнено ECN. У RFC2474 ці поля переозначено як 8\-бітні диференційні сервіси (DS), які складаються з бітів 0\-1 \- окремі дані (ECN знаходитиметься тут), і 2\-7 \- Differentiated Services Codepoint (DSCP). 

."  FIXME codepoint ? 

.TP
.B \fB\-q\fR
 Безшумний режим. Жодного виводу, окрім підсумкового рядка під час запуску, і по закінченню. 
.TP
.B \fB\-R\fR
 Запис маршруту. Додає опцію RECORD_ROUTE (запису маршруту) до пакету, і виводить буфер здійсненого маршруту з повернених пакетів. Зауважте, що IP\-заголовок здатний вмістити тільки вісім записів маршруту. Багато машин ігнорують або відкидають цю опцію. 
.TP
.B \fB\-r\fR
 Обхід звичайної таблиці маршрутизації, посилаючи пакети безпосередньо машині зі сполученим інтерфейсом. Якщо машина не знаходиться у безпосередньо\-приєднаній мережі, ця опція спричинить до повідомлення про помилку. Цю опцію можна застосувати для пінгування локальної машини (localhost) через інтерфейс, маршрут до якого не налагоджено (в таблиці маршрутизації), за умови що одночасно застосовано опцію \fB\-I\fR. 
.TP
.B \fB\-s\fR\fI розмір_пакету\fR
 Вказує яку кількість байтів даних відіслати. Стандартним значенням є 56, що утворює 64 байтів даних ICMP, якщо додати 8 байтів заголовку ICMP. 
.TP
.B \fB\-S\fR\fI розмір_буферу\fR
 Встановлює розмір буферу відправки (sndbuf) сокету. Якщо не вказано, то цей буфер може утримувати не більше одного пакету. 
.TP
.B \fB\-t\fR\fI ttl\fR
 Встановлює час життєздатності пакета (ttl \- time to live). 
.TP
.B \fB\-T\fR\fI опція_мітки_часу\fR
 Встановлює спеціальну опцію мітки часу IP. Аргументами можуть бути \fItsonly\fR (тільки мітки часу), \fItsandaddr\fR (мітки часу й адреси), або \fItsprespec машина1 \fR[\fIмашина2\fR [\fIмашина3\fR [\fIмашина4\fR]]] (мітки часу для окремих пунктів проходження). 
.TP
.B \fB\-M\fR\fI стратегія\fR
 Вибір стратегії визначення максимальної одиниці передачі (MTU \- Maximum Transfer Unit). Аргумент \fIстратегія\fR може складатися з \fIdo\fR (забороняє фрагментацію, навіть локальну), \fIwant\fR (здійснює PMTU\-визначення, фрагментує (ділить пакети) локально, якщо розмір 

."  FIXME: PMTU - як розшифровується? 

пакету завеликий, а також \fIdont\fR (не встановлює прапорця DF). 
.TP
.B \fB\-U\fR
 Виводить повний час затримки між машинами (старе поводження). Звичайно, \fBping\fR виводить мережний час обігу, який може відрізнятися, скажімо, з\-за несправності DNS (сервісу імен). 
.TP
.B \fB\-v\fR
 Багатослівний режим. 
.TP
.B \fB\-V\fR
 Виводить версію програми та завершує роботу. 
.TP
.B \fB\-w\fR\fI час_роботи\fR
 Вказує на час у секундах, після якого \fBping\fR завершує свою роботу, незалежно від того, скільки пакетів надіслано або отримано. В цьому випадку, \fBping\fR не завершується в залежності від кількості надісланих пакетів, програма очікує або вказаного часу завершення, або відповіді на певну кількість запитів, або після якогось мережного повідомлення про помилку. 
.TP
.B \fB\-W\fR\fI час_на_відповідь\fR
 Час очікування відповіді, в секундах. Ця опція впливає на ліміт часу у випадку відсутності будь\-якої відповіді, в протилежному випадку, \fBping\fR чекає впродовж двох RTT. 

."  FIXME: RTT - як розшифровується? 

Під час використання програми \fBping\fR для віднаходження мережних помилок, спершу слід застосувати її до локальної машини, щоб упевнитися, що локальний мережний інтерфейс дієздатний. Після цього, слід пінгувати подальші машини та шлюзи по мірі їхньої віддаленості. Програма обчислює час обігу та кількість втрачених пакетів. Якщо отримано дубльовані пакети, вони не включаються в обчислення втрачених пакетів, натомість час обігу цих пакетів додається до мінімального/середнього/максимального (minimum/average/maximum) часу обігу. Після того як відправлено (та отримано) вказану кількість пакетів, або коли програму перервано сигналом SIGINT, \fBping\fR виводить короткий підсумок. Коротшу поточну статистику можна отримати, коли не переривати процес сигналом SIGINT. 

Коли \fBping\fR не отримала жодних пакетів відповіді, статус її виходу дорівнюватиме 1. Коли вказано обидва \- кількість пакетів і час роботи, а отримано менше пакетів за вказану кількість по завершенню часу роботи, \fBping\fR також вийде зі статусом 1. У випадку інших помилок, програма повертає 2. При успішному виконанні код повернення дорівнює 0. Це дозволяє використання коду повернення, щоб визначити, чи досяжна певна машина, чи ні. 

Ця програма призначається для перевірки, вимірювання та керування мережею. Через навантаження, яке вона накладає на мережу, буде нерозумним використовувати її під час звичайного режиму роботи, або з автоматизованих скриптів. 

.SH "Докладніше про ICMP"
.PP
IP\-заголовок без байтів опцій має довжину 20 байтів. Пакет ICMP ECHO_REQUEST має додатково 8 байтів ICMP\-заголовку, за яким слідує певна кількість даних. Коли опцією \fB\-s\fR вказано розмір пакету, це встановить кількість цих додаткових даних (стандартно \- 56 байтів). Таким чином, розмір даних, отриманих всередині IP\-пакету ECHO_REPLY, завжди буде на 8 байтів більшим за розмір, вказаний опцією \fB\-s\fR. 

Якщо розмір даних є принаймні рівний розміру структури timeval, \fBping\fR використає початкові байти цього місця, щоби додати мітку часу, що застосовується програмою для обчислення часу обігу. Якщо ж простір даних менший, час обігу не виводитиметься. 

.SH "Дубльовані та пошкоджені пакети"
.PP
\fBping\fR повідомить про дубльовані та пошкоджені пакети. Дубльовані пакети не повинні з'являтися, а якщо так, то це пов'язано з недоречними ретрансляціями на апаратному рівні (link\-level). 

Серйознішим приводом для хвилювань являються пошкоджені пакети. Часто, вони є вказівником на зіпсовану апаратну частину десь на шляху пакетів \fBping\fR (в мережі, або машинах). 

.SH "Ланцюжки даних пакетів"
.PP
(Між)мережний рівень не повинен по\-різному розглядати пакети, в залежності від даних, які там містяться. Але, на\-жаль, відомі випадки коли в мережі закрадалися проблеми пов'язані з даними, і довгий час залишалися непомітними. В багатьох випадках, ланцюжки даних, що викликають проблеми, є занадто одноманітними (тобто такі, що містять самі нулі або самі одиниці). Однак, часом недостатньо вказати на командному рядку ланцюжок даних як такий, що складається з самих нулів (наприклад), оскільки ланцюжок, що нас цікавить знаходиться на апаратному рівні, і співвідношення між тим, що ви ввели і там, що надсилають контролери може виявитися складнішим. 

Це означає, що при наявності певної проблеми, пов'язаної з даними, вам доведеться здійснити багато тестів, щоб знайти її. Якщо повезе, то ви знайдете, наприклад, файл, який або неможливо переправити мережею, або його відправка займає набагато більше часу в порівнянні з файлами тієї самої довжини. В такому разі, ви можете оглянути цей файл щодо повторюваних ланцюжків, які ви можете виявити за допомогою опції \fB\-p\fR програми \fBping\fR. 

.SH "Стосовно TTL"
.PP
Значення TTL (часу життєздатності) IP\-пакету визначає максимальну кількість маршрутизаторів, через які пакет може пройти до того як його буде відкинуто. За сучасної практики, ви можете очікувати, що кожний маршрутизатор в Інтернеті зменшить TTL\-поле пакету рівно на одиницю. 

Специфікація TCP/IP заявляє, що TTL\-поле TCP\-пакетів повинні мати значення 60, але в багатьох системах це значення менше (4.3 BSD використовує 30, а 4.2 \- 15). 

Максимальним значенням цього поля може бути 255, і більшість Юнікс\-систем встановлюють TTL\-поле пакетів ECHO_REQUEST протоколу ICMP саме до 255\-и. Саме тому, може статися, що ви будучи спроможним пінгувати певні машини, не можете досягти їх за допомогою \fBtelnet\fR(1) або \fBftp\fR(1). 

За звичайних обставин, \fBping\fR виводить значення ttl кожного отриманого пакету. Коли віддалена система отримала ping\-пакет, вона у відповідь може здійснити одну з наступних трьох речей з TTL\-полем: 
.br
  *  Не змінювати його; саме так діяли системи Berkeley Unix до появи релізу 4.3BSD Tahoe. У цьому випадку, значення TTL отриманого пакету дорівнюватиме 255 мінус кількість маршрутизаторів під час обігу. 
.br
  *  Встановити його до 255\-и; саме так роблять сучасні системи Berkeley Unix. В такому разі, значення TTL дорівнюватиме 255 мінус кількість маршрутизаторів між віддаленою системою та машиною, з якої здійснюється пінгування. 
.br
  *  Встановити його до якогось іншого значення. Деякі машини використовують те саме значення TTL для ICMP\-пакетів, що і для TCP, наприклад 30 або 60. Інші взагалі встановлюють дикі значення. 

.SH "Вади"
.PP
Багато машин і маршрутизаторів ігнорують опцію RECORD_ROUTE. 

Максимальна довжина заголовка IP замала, щоб такі опції як RECORD_ROUTE були дійсно корисними. На жаль, це неможливо якось виправити. 

Повеневе пінгування, загалом, не рекомендовано, а повеневе пінгування трансляційної адреси необхідно здійснювати у надзвичайно контрольованих умовах. 

.SH "Дивіться також"
.PP
\fBnetstat\fR(8), \fBifconfig\fR(8)

.SH "Історія"
.PP
Команда \fBping\fR вперше з'явилася в 4.3BSD. 

Версія, описана тут, являється її нащадком, специфічним для Лінакса. 

.SH "Безпека"
.PP
\fBping\fR вимагає властивості CAP_NET_RAWIO для свого виконання. Програму можна вживати із дозволом set\-uid root. 

.SH "Наявність"
.PP
\fBping\fR є частиною пакету iputils, і останню версію програми можна знайти на анонімному ftp\-сервері за адресою ftp://ftp.inr.ac.ru/ip\-routing/iputils\-current.tar.gz.  

