." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "fenced" "8" "v 1.01.00 переклад альфа версія 2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "Кластерні файлові системи"

."Copyright (C) Sistina Software, Inc.  1997-2003  All rights reserved.
." Copyright (C) 2004 Red Hat, Inc.  All rights reserved.

.SH "ІМ'Я"
.PP

\fBfenced\fR \- сервіс захисту вводу/виводу.

.SH "ВИКОРИСТАННЯ"
.PP

.RS
.nf
    \fBfenced\fR [\fIOPTION\fR]...

.fi
.RE

.SH "ОПИС"
.PP

Сервіс захисту, \fBfenced\fR, мусить бути запущений на кожному вузлі, що використовує CLVM чи \fBGFS\fR. Він повинен запускатись одразу після приєднання вузла до кластеру \fBCMAN\fR (\fBfenced\fR використовується тільки з \fBCMAN\fR; і його не використовують з GULM/SLM/RLM.). Вузлу на якому не запущено \fBfenced\fR заборонено монтувати файлову систему \fBGFS\fR.

Всі сервіси захисту запускаються в кластері з групи під назвою "fence domain". Кожний член \fIfence domain\fR, котрий вийшов з ладу захиститься уявним членом домену. Дійсний захист не відбувається, хіба, що кластер має кворум такий, що падіння вузла приводить до втрат кворуму, тоді впавший вузол не захищається поки не відновиться кворум. Якщо впавший вузол, член домену, (належно захищений) приєднується до кластеру дійсна чергова операція захисту відміняється, операція захисту пройде.

Сервіс захисту залежить від \fBCMAN\fR для інформації членства в кластері котрий в свою чергу залежить від \fBCCS\fR для надання інформації через \fBcluster.conf\fR. Сервіс захисту звертається до агенту захисту згідно до інформації у  \fBcluster.conf\fR.

.SS "Падіння вузла"
.PP

Коли член домену падає, дійсна операція захисту мусить здійснитись перед початком відновлення \fBGFS\fR. Це означає, що будь\-яка затримка в здійсненні захисту призведе до затримки виконання операцій файловою системою \fBGFS\fR, більшість операцій файлової системи буде заблокованим протягом цього періоду.

Коли член домену падає, здійснення операції захисту може затриматись на вказану в конфігурації кількість секунд (\fBpost_fail_delay\fR чи \fB\-f\fR). Протягом цього часу впавший вузол може приєднатись знов до кластеру ы відмінити свій захист. Час затримки по замовчуванню рівний \fB0\fR для мінімізації часу протягом котрого програми, що використовують GFS очікують відновлення. Затримка в \fB\-1\fR заставить сервіс захисту чекати невизначений період поки впавший вузол не приєднається до кластеру.

.SS "Запуск домену"
.PP

Коли домен вперше створюється в кластері (приєднанням до домену першого вузла) і наступного включення (приростом кластерного кворуму) будь\-яких вузлів перелічених у \fBcluster.conf\fR, що не є присутніми членами кластеру \fBCMAN\fR захищаються. Статус цих вузлів є невідомий і для забезпечення належної безпеки вони потребують захисту. Захист при старті домену можна відмінити, але це буде дійсно безпечно тільки у випадку, якщо оператор є присутній для визначення, що ні один вузол кластеру не потребує захисту. (Загрозливі вузли, що потребують захисту, є ті котрі мали примонтовану gfs, і не відмонтували її повністю і зараз перебувають або завизші, або від'єднанні від мережі інших вузлів.)

Перший шлях для запобігання зайвому захисту вузлів при старті полягає в перевірці, що кожний вузол приєднався до кластеру перед тим як котрийсь вузол запустить сервіс захисту. Цей шлях трошки складний для автоматизації.

Другий шлях для запобігання зайвому захисту вузлів при старті полягає у використанні \fBpost_join_delay\fR параметру (чи опції \fB\-j\fR). Це число секунд протягом яких сервіс захисту буде затриманий перед початком здійснення захисту будь\-якої жертви після приєднання вузлів до домену. ця затримка дає шанс кожному вузлу, що захищається, приєднатись до кластеру і уберегтися від можливості бути захищеним. Затримка тут в \fB\-1\fR призведе до очікування сервісом невизначеного проміжку часу для приєднання всіх вузлів до кластеру і ні один вузол не буде захищеним протягом запуску домену.

Для відміни захисту при створенні домену, використовують опцію \fB\-c\fR для оголошення, що всі вузли є в чистому чи безпечному стані для старту. Опція \fBclean_start\fR в  \fBcluster.conf\fR може бути встановлення для такої ж поведінки, але автоматична відміна захисту в \fBcluster.conf\fR приводить до ризику пошкодити файлову систему.

Запобігання від зайвого захисту при старті переважно використовують коли вузли є захищені by power  cycling. Якщо вузли є захищені відключенням їх доступу SAN, тоді відміна захисту вузлів зазвичай менш руйнівна.

.SH "ФАЙЛ НАЛАШТУВАНЬ"
.PP

Поведінка сервісу захисту контролюється відповідними опціями у файлі \fBcluster.conf\fR в розділі \fB<fence_daemon>  </fence_daemon>\fR. Дивіться вище для пояснення значень змінних. Затримка вимірюється секундами; \fB\-1\fR секунда означає необмежений час затримки. Вказані значення є по замовчуванню.

Затримка після приєднання вузла до домену є кількість секунд протягом котрих сервіс буде чекати перед захистом жертв.

.RS
.nf
         <fence_daemon post_join_delay="3">
         </fence_daemon>

.fi
.RE
Затримка після падіння члену домену в секундах протягом котрої сервіс очікує перед здійсненням захисту будь\-якої жертви

.RS
.nf
         <fence_daemon post_fail_delay="0">
         </fence_daemon>

.fi
.RE
Запобігання від зайвого захисту при старті використовують для заборони здійснення захисту сервісом при старті. Вона вказує сервісу, що всі вузли є в чистому стані для старту.

.RS
.nf
         <fence_daemon clean_start="0">
         </fence_daemon>

.fi
.RE

.SH "ОПЦІЇ"
.PP

Опції командного рядка змінюють відповідні значення вказані в файлі налаштувань \fIcluster.conf\fR

.TP
.B \fB\-j\fR \fIsecs\fR
Затримка після старту

.TP
.B \fB\-f\fR \fIsecs\fR
Затримка після виявлення падіння вузла

.TP
.B \fB\-c\fR
Всі вузли при старті вважати в чистому стані.

.TP
.B \fB\-D\fR
Включає відлагоджувальний режим і не переходить у фоновий режим

.TP
.B \fB\-n\fR \fIname\fR
Ім'я домену захисту по замовчуванню "default".

.TP
.B \fB\-V\fR
Видруковує інформацію про версію та припиняє роботу.

.TP
.B \fB\-h\fR
Видруковує довідкову інформацію про допустимі опції і припиняє роботу.

.RS
.nf
       

.fi
.RE

.SH "ДИВІТЬСЯ ТАКОЖ"
.PP

\fBgfs(8)\fR, \fBfence(8)\fR.

