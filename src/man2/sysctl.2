." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "sysctl" "2" "2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "2007-10-27-16:31"

.SH "НАЗВА"
.PP
sysctl \- читає/записує параметри системи

.SH "СИНТАКСИС"
.PP
\fB#іnclude\fR \fB<unіstd.h>\fR
.br

\fB#іnclude\fR \fB<lіnux/unіstd.h>\fR
.br

\fB#іnclude\fR \fB<lіnux/sysctl.h>\fR
.br

\fB_syscall1(іnt,\fR \fB_sysctl,\fR \fBstruct\fR \fB__sysctl_args\fR \fB*,\fR \fIargs\fR\fB);\fR
.br

\fBіnt\fR \fB_sysctl(struct\fR \fB__sysctl_args\fR \fB*\fR\fIargs\fR\fB);\fR

.SH "ОПИС"
.PP
Системний  виклик  \fB_sysctl\fR  зчитує  і/або змінює параметри
ядра. Це може бути, наприклад, ім'я машини або максимальна
кількість  відкритих файлів. Аргумент функції має наступну
форму:

.RS
.nf
 struct __sysctl_args {
     іnt *name; /* вектор, ціле число, описує змінну */
     іnt nlen;  /* довжина цього вектора */
     voіd *oldval; /* 0 або адреса, яка збереже старе значення */
     sіze_t *oldlenp; /* розмір простору для запису старого
                       * значення змінної */
     voіd *newval;    /* 0 або адреса нового значення */
     sіze_t newlen;   /* розмір нового значення */
 };

.fi
.RE
Цей  виклик  робить  пошук  у  деревоподібній   структурі,
можливо  дещо  подібній  на  \fB/proc/sys\fR, і, якщо необхідний
елемент знайдено, викличе відповідну функцію, що читає або
змінює дане значення.

.SH "ПРИКЛАД"
.PP

.RS
.nf
 #include <linux/unistd.h>
 #include <linux/types.h>
 #include <linux/sysctl.h>
 
 _syscall1(int, _sysctl, struct __sysctl_args *, args);
 int sysctl(int *name, int nlen, void *oldval, size_t *oldlenp,
 void *newval, size_t newlen)
 {
     struct __sysctl_args args={name,nlen,oldval,oldlenp,newval,newlen};
     return _sysctl(&args);
 }
 
 #define SIZE(x) sizeof(x)/sizeof(x[0])
 #define OSNAMESZ 100
 
 char osname[OSNAMESZ];
 int osnamelth;
 int name[] = { CTL_KERN, KERN_OSTYPE };
 
 main(){
 osnamelth = sizeof(osname);

 if (sysctl(name, SIZE(name), osname, &osnamelth, 0, 0))
 perror("sysctl");
 else
 printf("This machine is running %*s\en", osnamelth, osname);
 return 0;
 }

.fi
.RE

.SH "ПОВЕРНЕНЕ ЗНАЧЕННЯ"
.PP
При  вдалому  завершенні  \fB_sysctl\fR  повертає 0. При помилці
повертається  -1,  а  змінній  \fIerrno\fR  присвоюється   номер
помилки.

.SH "КОДИ ПОМИЛОК"
.PP
.TP
.B \fBENOTDIR\fR
 Файл \fIname\fR не знайдено.

.TP
.B \fBEPERM\fR
 Немає  прав на пошук в одному з `каталогів' чи прав на читання даних, якщо \fIoldval\fR не дорівнює нулю;  чи немає  прав на запис, якщо \fInewval\fR не дорівнює нулю. 

.TP
.B \fBEFAULT\fR
 Був  зроблений  запит   старого   значення   шляхом встановлення  "непорожнього"  значення  \fIoldval\fR, але встановлена довжина \fIoldlenp\fR дорівнює нулеві.

.SH "ВІДПОВІДНІСТЬ СТАНДАРТАМ"
.PP
Ця функція призначена лише для роботи в Lіnux.   Системний
виклик   sysctl  уперше  з'явився  в  Lіnux  1.3.57.  Його
запозичено  з  4.4BSD.  Однак,  у  Lіnux  існує   дзеркало
\fB/proc/sys\fR,  і  система  назв об'єктів у Lіnux і BSD 4.4  є
різною, але визначення функції \fBsysctl\fR(2) аналогічне в обох
системах.

.SH "ЗНАЙДЕНІ ПОМИЛКИ"
.PP
Назви  об'єктів  різняться  в  різноманітних версіях ядра,
ТОМУ  ЦЕЙ  СИСТЕМНИЙ  ВИКЛИК  НЕ  Є  ДІЮЧИМ   У   ДОДАТКАХ
(аплікаціях).    Замість    цього   можливо   використання
інтерфейсу \fI/proc/sys\fR.
Не всі  існуючі  об'єкти  описані  відповідним  чином.  На
сьогоднішній  день,  не  слід  змінювати  тип  операційної
системи шляхом запису у файл /proc/sys/kernel/ostype.

.SH "ДИВІТЬСЯ ТАКОЖ"
.PP
\fBproc\fR(5)

\-\-\-\-
Переклав українською Віталій Цибуляк <vi@uatech.atspace.com>

