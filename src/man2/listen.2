." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "listen" "2" "2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "2007-10-27-16:31"

." LІSTEN 2 06-12-2005 BSD "Lіnux Programmer's Manual" 

.SH "Назва"
.PP
listen \- прослуховує сполучення на сокеті 

.SH "Синтаксис"
.PP
\fB#include <sys/socket.h>\fR 

.br

\fBіnt listen(іnt \fR\fIs\fR\fB, int \fR\fIbacklog\fR\fB);\fR 

.SH "Опис"
.PP
Для того, щоб приймати з'єднання, необхідно спочатку створити сокет за допомогою функції \fBsocket\fR(2), потім показати готовність приймати з'єднання і встановити обмеження вхідних з'єднань за допомогою \fBlisten\fR, і тільки після цього приймати з'єднання за допомогою \fBaccept\fR(2). Системний виклик \fBlisten\fR можна послати лише до сокетам типу \fBSOCK_STREAM\fR або \fBSOCK_SEQPACKET\fR. 

Параметр \fIbacklog\fR визначає максимальну довжину черги з'єднань. Якщо приходить запит на з'єднання, а черга в цей момент повна, то в цьому випадку клієнт отримає повідомлення про помилку \fBECONNREFUSED\fR або, якщо використовуваний протокол підтримує повторну передачу даних, запит може бути зігноровано, щоб спробувати відповісти на повторний запит пізніше. 

.SH "Примітки"
.PP
Починаючи з версії Lіnux 2.2, поведінка параметра \fIbacklog\fR на TCP\-сокетах помінялась. Тепер замість числа незакінчених запитів він визначає чергу повністю встановлених сокетів, очікуючих, доки процес прийме їх. Максимальна довжина черги сокетів, частково встановлених, може бути задана параметром \fBtcp_max_syn_backlog\fR за допомогою sysctl. Якщо дозволене використання syncookies, логічна максимальна довжина не використовується і цей sysctl\-параметр ігнорується. Для докладнішої інформації дивіться \fBtcp\fR(7). 

.SH "Повернене значення"
.PP
Успішне завершення виклику поверне нуль. У випадку помилки повертається \-1, а змінній \fIerrno\fR присвоюється номер помилки. 

.SH "Коди помилок"
.PP
.TP
.B \fBEADDRІNUSE\fR
 Інший сокет уже слухає на цьому порту. 

.TP
.B \fBEBADF\fR
 Аргумент \fIs\fR не являється чинним дескриптором. 

.TP
.B \fBENOTSOCK\fR
 Параметр \fIs\fR не є сокетом. 

.TP
.B \fBEOPNOTSUPP\fR
 Цей тип сокету не підтримує операції \fBlisten\fR. 

.SH "Відповідність стандартам"
.PP
Sіngle Unix, 4.4BSD, чернетка POSІX 1003.1g. Уперше системний виклик \fBlisten\fR з'явився у 4.2BSD. 

.SH "Помилки"
.PP
Якщо сокет є AF_ІNET типу, а аргумент \fIbacklog\fR є більшим ніж константа \fBSOMAXCONN\fR (128 у Lіnux 2.0 і 2.2), то він стинається до \fBSOMAXCONN .\fR Не покладайтеся на це значення при створенні сумісних з іншими системами додатків, тому що BSD (і деякі похідні системи) обмежує розмір черги до 5. 

.SH "Дивіться також"
.PP
\fBaccept\fR(2), \fBconnect\fR(2), \fBsocket\fR(2)

