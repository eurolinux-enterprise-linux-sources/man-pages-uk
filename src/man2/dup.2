." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "dup" "2" "2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "2007-10-27-16:31"

.SH "НАЗВА"
.PP
dup, dup2 \- дублює дескриптор файлу

.SH "СТИСЛИЙ ОГЛЯД"
.PP
\fB#include\fR \fB<unistd.h>\fR

\fBint\fR \fBdup(int\fR \fIoldfd\fR\fB);\fR
.br

\fBint\fR \fBdup2(int\fR \fIoldfd\fR\fB,\fR \fBint\fR \fInewfd\fR\fB);\fR
.br

.SH "ОПИС"
.PP
\fBdup\fR і \fBdup2\fR створюють копію дескриптору файлу \fIoldfd\fR.
Після успішного завершення \fBdup\fR або \fBdup2\fR, новий і старий
дескриптор можуть використовуватись взаємозамінно. Вони
спільно використовують ті самі замки (locks), покажчики на
позицію файлу і прапорці. Прикладом, якщо позиція одного з
файлів\-дескрипторів помінялась завдяки \fBlseek\fR, це буде
дійсним також і для другого дескриптору.

Два дескриптори не поділяють прапорець close\-on\-exec
(закриття по виконанню), тим не менш.

\fBdup\fR використовує вільний дескриптор з найменшим порядковим
номером для нового дескриптору.

\fBdup2\fR створює \fInewfd\fR як копію \fIoldfd\fR, закриваючи першим
\fInewfd\fR, якщо необхідно.

.SH "ПОВЕРНЕНЕ ЗНАЧЕННЯ"
.PP
\fBdup\fR і \fBdup2\fR повертають новий дескриптор, або -1, якщо
виникла якась помилка (у такому випадку, \fIerrno\fR також
отримає відповідне значення).

.SH "КОДИ ПОМИЛОК"
.PP

.TP
.B \fBEBADF\fR
 \fIoldfd\fR не являється відкритим дескриптором файлу, або \fInewfd\fR знаходиться поза межами дозволених дескрипторів файлів.
.TP
.B \fBEMFILE\fR
 Процес відкрив максимально дозволену кількість дескрипторів файлів і намагається відкрити ще один.
.TP
.B \fBEINTR\fR
 Виклик \fBdup2\fR було перервано якимось сигналом.
.TP
.B \fBEBUSY\fR
 (Тільки для Лінукса) може бути повернутим \fBdup2\fR під час стану перегону (race condition) з \fBopen()\fR або \fBdup()\fR.

.SH "ПОПЕРЕДЖЕННЯ"
.PP
Помилка, що повертається \fBdup2\fR відрізняється від того, що
повертає \fBfcntl(...,\fR \fBF_DUPFD,\fR \fB...)\fR, якщо \fInewfd\fR знаходиться поза межами дозволених дескрипторів файлів. На деяких системах, \fBdup2\fR також повертає \fBEINVAL\fR, так само як \fBF_DUPFD\fR.

.SH "ВАДИ"
.PP
Під час відкриття \fInewfd\fR, усі помилки, які могли би бути
звітовані під час \fBclose()\fR безнадійно втрачаються.
Обережний програміст не використовуватиме \fBdup2\fR без
закриття \fInewfd\fR спочатку.

.SH "ВІДПОВІДНІСТЬ СТАНДАРТАМ"
.PP
SVr4, SVID, POSIX, X/OPEN, BSD 4.3. SVr4 описує додаткові
стани помилок EINTR і ENOLINK. POSIX.1 додав EINTR.
Повернення EBUSY є характерним лише для Лінукса.

.SH "ДИВІТЬСЯ ТАКОЖ"
.PP
\fBfcntl\fR(2), \fBopen\fR(2), \fBclose\fR(2)

\-\-\-\-
Переклав Віталій Цибуляк <vi@uatech.atspace.com>

