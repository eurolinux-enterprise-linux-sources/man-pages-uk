." © 2005-2007 DLOU, GNU FDL
." URL: <http://docs.linux.org.ua/index.php/Man_Contents>
." Supported by <docs@linux.org.ua>
."
." Permission is granted to copy, distribute and/or modify this document
." under the terms of the GNU Free Documentation License, Version 1.2
." or any later version published by the Free Software Foundation;
." with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
." 
." A copy of the license is included  as a file called COPYING in the
." main directory of the man-pages-* source package.
."
." This manpage has been automatically generated by wiki2man.py
." This tool can be found at: <http://wiki2man.sourceforge.net>
." Please send any bug reports, improvements, comments, patches, etc. to
." E-mail: <wiki2man-develop@lists.sourceforge.net>.

.TH "cluster.conf" "5" "2007-10-27-16:31" "© 2005-2007 DLOU, GNU FDL" "2007-10-27-16:31"

."Copyright (C) Sistina Software, Inc.  1997-2003  All rights reserved.
." Copyright (C) 2004 Red Hat, Inc.  All rights reserved.

.SH "НАЗВА"
.PP

\fBcluster.conf\fR \- загальний файл налаштувань для кластерних рішень.

.SH "ОПИС"
.PP

Файл \fBcluster.conf\fR знаходиться в каталозі /etc/cluster. Він є джерелом інформації для кластерних програм \- яку вони отримують через посередництво \fBccs(7)\fR. Цей файл містить всю необхідну інформацію для роботи кластеру, таку, як: з яких вузлів складається кластер та як працює захист вводу/виводу на них. Це загальна інформація, що відноситься до всієї кластерної інфраструктури  так само як деяка специфічна інформація, що стосується конкретних кластерних продуктів.

Ця сторінка підручника описує загальний вміст файлу \fIcluster.conf\fR. Специфіка пов'язана з окремими програмами залишається для опису відповідним сторінкам підручника. Для прикладу, після складання загального опису користувачам буде потрібно заглянути до сторінки підручника \fBlock_gulmd(5)\fR, якщо користуєтесь \fBlock_gulmd\fR як сервером блокування. Відповідно, користувачам dlm варто глянути у \fBcman(5)\fR та \fBdlm(5)\fR для подальших інструкцій.

Файл \fBcluster.conf\fR складено у форматі XML. Він має одну загальну секцію яка містить всі інші згруповані секції. На початку секції кластеру міститься два делегованих атрибути: \fIname\fR та \fIconfig_version\fR. Атрибут \fIname\fR оголошує ім'я кластеру. Важливим є унікальність цього імені від інших кластерів, що користувач можливо підійме. Атрибут \fIconfig_version\fR є номером котрий використовують для визначення версії файлу \fBcluster.conf\fR. Записавши цю інформацію Ваш \fBcluster.conf\fR файл виглядатиме наступним чином:

.RS
.nf
       <cluster name="alpha" config_version="1">
       </cluster>

.fi
.RE
Делегованим підрозділом головної секції \fIcluster\fR є \fIfencedevices\fR. Вона містить всі пристрої з захищеним вводом/виводом з котрих складається кластер. Пристрої захищеного I/O  перелічені в підсекції з назвою \fIfencedevice\fR та містять атрибути, що описують конкретний пристрій. Для прикладу:

.RS
.nf
         <fencedevices>
           <fencedevice name="apc" agent="fence_apc"
                   ipaddr="apc_1" login="apc" passwd="apc"/>
         </fencedevices>

.fi
.RE
Після підсекції \fIfencedevice\fR, мусять бути оголошені ім'я та атрибути агенту для всіх пристроїв з захищеним вводом/виводом. Очікувані атрибути залежать від пристрою і використовуються для опису специфічної, необхідної інформації потрібної для доступу до пристрою. Атрибут імені \fIname\fR повинен бути унікальним і використовується для звертання до пристрою з захищеним I/O в інших секціях файлу \fBcluster.conf\fR. Атрибут агенту \fIagent\fR використовується для вказання двійкової програми\-агенту, що використовується з конкретним пристроєм. Зараз ваш файл \fBcluster.conf\fR повинен виглядати приблизно так:

.RS
.nf
       <cluster name="alpha" config_version="1">
         <fencedevices>
           <fencedevice name="apc" agent="fence_apc"
                   ipaddr="apc_1" login="apc" passwd="apc"/>

           <fencedevice name="brocade" agent="fence_brocade"
                   ipaddr="brocade_1" login="bro" passwd="bro"/>

           
." The WTI fence device requires no login name 

           <fencedevice name="wti" agent="fence_wti"
                   ipaddr="wti_1" passwd="wti"/>

           <fencedevice name="last_resort" agent="fence_manual"/>
         </fencedevices> </cluster>

.fi
.RE
Заключною делегуючою підсекцією \fIcluster\fR є \fIclusternodes\fR. Вона містить індивідуальні специфікації всіх машин, членів кластеру. Кожна машина має свою секцію \fIclusternode\fR, що містить атрибут імені \fIname\fR \- яке мусить співпадати з іменем машини. Секція \fIclusternode\fR також містить підсекцію \fIfence\fR (не сплутайте з секцією \fIfencedevices\fR), секція \fIfence\fR використовується для вказання всіх можливих методів "method" захисту конкретної машини, подібно до того як \fIdevice\fR використовується для визначення методу та необхідних специфічних параметрів машини. Секція вузла кластеру може виглядати наступним чином:

.RS
.nf
         
." This example only contains one machine 

         <clusternodes>
           <clusternode name="nd01">
             <fence>
               
." "power" method is tried before all others 

               <method name="power">
                 <device name="apc" port="1:1"/>
               </method>
               
." If the "power" method fails,
."                     try fencing through the "fabric" 

               <method name="fabric">
                 <device name="brocade" port="1"/>
               </method>      
." If all else fails,
."                     make someone do it manually 

               <method name="human">
                 <device name="last_resort" ipaddr="nd01"/>
               </method>
             </fence>
           </clusternode>
         </clusternodes>

.fi
.RE
Зібравши все разом, файл налаштувань \fBcluster.conf\fR для трьохвузлового кластеру виглядатиме так:

.RS
.nf
       <cluster name="example" config_version="1">
         <clusternodes>
           <clusternode name="nd01">
             <fence>
               
." "power" method is tried before all others 

               <method name="power">
                 <device name="apc" port="1:1"/>
               </method>
               
." If the "power" method fails,
."                     try fencing through the "fabric" 

               <method name="fabric">
                 <device name="brocade" port="1"/>
               </method>      
." If all else fails,
."                     make someone do it manually 

               <method name="human">
                 <device name="last_resort" ipaddr="nd01"/>
               </method>
             </fence>
           </clusternode>
           <clusternode name="nd02">
             <fence>
               
." "power" method is tried before all others 

               <method name="power">
                 <device name="apc" port="1:2"/>
               </method>
               
." If the "power" method fails,
."                     try fencing through the "fabric" 

               <method name="fabric">
                 <device name="brocade" port="2"/>
               </method>      
." If all else fails,
."                     make someone do it manually 

               <method name="human">
                 <device name="last_resort" ipaddr="nd02"/>
               </method>
             </fence>
           </clusternode>
           <clusternode name="nd11">
             <fence>
               
." "power" method is tried before all others 

               <method name="power">
                 
." This machine has 2 power supplies 

                 <device name="apc" port="2:1"/>
                 <device name="wti" port="1"/>
               </method>
               
." If the "power" method fails,
."                     try fencing through the "fabric" 

               <method name="fabric">
                 <device name="brocade" port="11"/>
               </method>      
." If all else fails,
."                     make someone do it manually 

               <method name="human">
                 <device name="last_resort" ipaddr="nd11"/>
               </method>
             </fence>
           </clusternode>
         </clusternodes>

         <fencedevices>
           <fencedevice name="apc" agent="fence_apc"
                   ipaddr="apc_1" login="apc" passwd="apc"/>

           <fencedevice name="brocade" agent="fence_brocade"
                   ipaddr="brocade_1" login="bro" passwd="bro"/>

           
." The WTI fence device requires no login name 

           <fencedevice name="wti" agent="fence_wti"
                   ipaddr="wti_1" passwd="wti"/>

           <fencedevice name="last_resort" agent="fence_manual"/>
         </fencedevices> </cluster>

.fi
.RE

.SH "ДИВІТЬСЯ ТАКОЖ"
.PP

\fBccs(7)\fR, \fBccs_tool(8)\fR, \fBcman(5)\fR, \fBlock_gulmd(5)\fR.

